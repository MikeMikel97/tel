; ============================================
; PJSIP CONFIGURATION
; ============================================
; 
; ВАЖНО: Динамическая конфигурация из БД
; Используйте API для применения: POST /api/admin/asterisk/apply-config
;
#include dynamic/pjsip_dynamic.conf

[global]
type=global
max_forwards=70
user_agent=Asterisk PBX
default_outbound_endpoint=mango-trunk

; ============================================
; TRANSPORTS
; ============================================

; UDP транспорт для SIP
[transport-udp]
type=transport
protocol=udp
bind=0.0.0.0:5060
external_media_address=0.0.0.0
external_signaling_address=0.0.0.0

; WebSocket транспорт для WebRTC
[transport-ws]
type=transport
protocol=ws
bind=0.0.0.0:8088

; ============================================
; WEBRTC ENDPOINT (для браузерного телефона)
; ============================================

[operator]
type=endpoint
context=internal
disallow=all
allow=opus
allow=ulaw
webrtc=yes
transport=transport-ws
auth=operator-auth
aors=operator
direct_media=no
ice_support=yes
media_encryption=dtls
dtls_verify=fingerprint
dtls_auto_generate_cert=yes
dtls_setup=actpass
dtls_rekey=0
rtcp_mux=yes
use_avpf=yes
force_avp=no
rtp_symmetric=yes
force_rport=yes
rewrite_contact=yes

[operator-auth]
type=auth
auth_type=userpass
username=operator
password=operator123
realm=asterisk

[operator]
type=aor
max_contacts=5
remove_existing=yes

; ============================================
; MANGO OFFICE TRUNK
; Включаем конфигурацию из отдельного файла
; ============================================
#include pjsip_mango.conf
