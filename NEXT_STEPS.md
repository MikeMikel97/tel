# üöÄ –ß–¢–û –î–ï–õ–ê–¢–¨ –î–ê–õ–¨–®–ï

## ‚úÖ –ß—Ç–æ —É–∂–µ –≥–æ—Ç–æ–≤–æ:
- ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ —Å–æ–∑–¥–∞–Ω–∞
- ‚úÖ Backend –Ω–∞ FastAPI —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π OpenRouter + Soniox
- ‚úÖ –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (frontend)
- ‚úÖ –ö–æ–Ω—Ñ–∏–≥–∏ –¥–ª—è Asterisk + Mango Office
- ‚úÖ Docker setup

---

## üìù –ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π

### 1Ô∏è‚É£ –ü–æ–ª—É—á–∏ API –∫–ª—é—á–∏ (5 –º–∏–Ω—É—Ç)

**OpenRouter** (–¥–ª—è LLM - Claude, GPT –∏ —Ç.–¥.):
- –ó–∞–π–¥–∏ –Ω–∞ https://openrouter.ai/
- –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Å—è / –≤–æ–π–¥–∏
- –ü–µ—Ä–µ–π–¥–∏ –≤ Keys: https://openrouter.ai/keys
- –°–æ–∑–¥–∞–π –Ω–æ–≤—ã–π –∫–ª—é—á ‚Üí —Å–∫–æ–ø–∏—Ä—É–π (–Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `sk-or-v1-...`)
- –ü–æ–ø–æ–ª–Ω–∏ –±–∞–ª–∞–Ω—Å $5-10 –¥–ª—è —Å—Ç–∞—Ä—Ç–∞

**Soniox** (–¥–ª—è —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ –Ω–∞ —Ä—É—Å—Å–∫–æ–º):
- –ó–∞–π–¥–∏ –Ω–∞ https://soniox.com/
- –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Å—è
- –ü–æ–ª—É—á–∏ API –∫–ª—é—á (–µ—Å—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ —á–∞—Å—ã –¥–ª—è —Ç–µ—Å—Ç–∞)

---

### 2Ô∏è‚É£ –ù–∞—Å—Ç—Ä–æ–π Asterisk –Ω–∞ VPS (15 –º–∏–Ω—É—Ç)

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É
ssh root@155.212.184.103

# –°–æ–∑–¥–∞–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è –∑–∞–ø–∏—Å–µ–π
mkdir -p /var/spool/asterisk/recording
chown asterisk:asterisk /var/spool/asterisk/recording
chmod 755 /var/spool/asterisk/recording
```

**–î–æ–±–∞–≤—å –∫–æ–Ω—Ñ–∏–≥–∏:**

–°–∫–ª–æ–Ω–∏—Ä—É–π –ø—Ä–æ–µ–∫—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∏–ª–∏ —Å–∫–æ–ø–∏—Ä—É–π —Ñ–∞–π–ª—ã:

```bash
# –í–∞—Ä–∏–∞–Ω—Ç 1: –ö–ª–æ–Ω–∏—Ä—É–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
cd /tmp
git clone <—Ç–≤–æ–π-—Ä–µ–ø–æ> telephony
cd telephony

# –í–∞—Ä–∏–∞–Ω—Ç 2: –°–∫–æ–ø–∏—Ä—É–π —Å –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã
# –ù–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π:
scp -r asterisk/* root@155.212.184.103:/tmp/asterisk-configs/
```

**–û–±–Ω–æ–≤–∏ –∫–æ–Ω—Ñ–∏–≥–∏ Asterisk:**

```bash
# –î–æ–±–∞–≤—å SIP —Ç—Ä–∞–Ω–∫ Mango –≤ –∫–æ–Ω–µ—Ü pjsip.conf
cat /tmp/telephony/asterisk/pjsip_mango.conf >> /etc/asterisk/pjsip.conf

# ‚ö†Ô∏è –í–ê–ñ–ù–û: –û—Ç–∫—Ä–æ–π /etc/asterisk/pjsip.conf –∏ –∑–∞–º–µ–Ω–∏ "–¢–í–û–ô_–ü–ê–†–û–õ–¨_–°–Æ–î–ê" –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π –ø–∞—Ä–æ–ª—å –æ—Ç Mango
nano /etc/asterisk/pjsip.conf
# –ù–∞–π–¥–∏ —Å—Ç—Ä–æ–∫—É: password=–¢–í–û–ô_–ü–ê–†–û–õ–¨_–°–Æ–î–ê
# –ó–∞–º–µ–Ω–∏ –Ω–∞ —Ç–≤–æ–π –ø–∞—Ä–æ–ª—å –æ—Ç operator1@vpbx400362386.mangosip.ru

# –î–æ–±–∞–≤—å –¥–∏–∞–ª–ø–ª–∞–Ω
cat /tmp/telephony/asterisk/extensions_mango.conf >> /etc/asterisk/extensions.conf

# –°–∫–æ–ø–∏—Ä—É–π ARI –∏ HTTP –∫–æ–Ω—Ñ–∏–≥–∏
cp /tmp/telephony/asterisk/ari.conf /etc/asterisk/ari.conf
cp /tmp/telephony/asterisk/http.conf /etc/asterisk/http.conf

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏ Asterisk
asterisk -rx "core reload"

# –ü—Ä–æ–≤–µ—Ä—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é —Ç—Ä–∞–Ω–∫–∞ (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å Registered)
asterisk -rx "pjsip show registrations"

# –ü—Ä–æ–≤–µ—Ä—å endpoint
asterisk -rx "pjsip show endpoint mango-trunk"

# –ï—Å–ª–∏ –µ—Å—Ç—å –æ—à–∏–±–∫–∏ - —Å–º–æ—Ç—Ä–∏ –ª–æ–≥–∏
asterisk -rvvv
```

---

### 3Ô∏è‚É£ –ó–∞–ø—É—Å—Ç–∏ Backend –ª–æ–∫–∞–ª—å–Ω–æ (10 –º–∏–Ω—É—Ç)

```bash
# –ù–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ
cd backend

# –°–æ–∑–¥–∞–π –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
python3 -m venv venv
source venv/bin/activate  # Linux/Mac
# –∏–ª–∏: venv\Scripts\activate  # Windows

# –£—Å—Ç–∞–Ω–æ–≤–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -r requirements.txt

# –°–æ–∑–¥–∞–π .env —Ñ–∞–π–ª
cp env.example .env

# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π .env (–æ—Ç–∫—Ä–æ–π –≤ –ª—é–±–æ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ)
nano .env
# –∏–ª–∏
code .env

# –í–ø–∏—à–∏ —Å–≤–æ–∏ –∫–ª—é—á–∏:
OPENROUTER_API_KEY=sk-or-v1-—Ç–≤–æ–π-–∫–ª—é—á-—Å—é–¥–∞
SONIOX_API_KEY=—Ç–≤–æ–π-soniox-–∫–ª—é—á
ASTERISK_HOST=155.212.184.103
```

**–ó–∞–ø—É—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä:**

```bash
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

–î–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è:
```
INFO:     Uvicorn running on http://0.0.0.0:8000
INFO:     Application startup complete.
```

–û—Ç–∫—Ä–æ–π –≤ –±—Ä–∞—É–∑–µ—Ä–µ: http://localhost:8000/api/health

–î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å:
```json
{
  "status": "healthy",
  "asterisk": "155.212.184.103",
  "active_calls": 0,
  "ws_connections": 0
}
```

---

### 4Ô∏è‚É£ –ó–∞–ø—É—Å—Ç–∏ Frontend (2 –º–∏–Ω—É—Ç—ã)

**–û—Ç–∫—Ä–æ–π—Ç–µ –Ω–æ–≤—ã–π —Ç–µ—Ä–º–∏–Ω–∞–ª:**

```bash
cd frontend

# –ó–∞–ø—É—Å—Ç–∏ –ø—Ä–æ—Å—Ç–æ–π HTTP —Å–µ—Ä–≤–µ—Ä
python3 -m http.server 3000

# –ò–ª–∏ —á–µ—Ä–µ–∑ Node.js:
npx serve -l 3000
```

**–û—Ç–∫—Ä–æ–π –≤ –±—Ä–∞—É–∑–µ—Ä–µ:**
- http://localhost:3000

–î–æ–ª–∂–µ–Ω –æ—Ç–∫—Ä—ã—Ç—å—Å—è –∫—Ä–∞—Å–∏–≤—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å AI Call Agent.

---

### 5Ô∏è‚É£ –¢–µ—Å—Ç–∏—Ä—É–π! üéâ

#### **–í–∞—Ä–∏–∞–Ω—Ç 1: –î–µ–º–æ-—Ä–µ–∂–∏–º (–±–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∑–≤–æ–Ω–∫–∞)**

1. –í –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ –Ω–∞–∂–º–∏ **"–î–µ–º–æ –∑–≤–æ–Ω–æ–∫"**
2. –ü–æ—è–≤–∏—Ç—Å—è —Å–∏–º—É–ª—è—Ü–∏—è –∑–≤–æ–Ω–∫–∞ —Å —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–µ–π
3. AI –±—É–¥–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

#### **–í–∞—Ä–∏–∞–Ω—Ç 2: –†–µ–∞–ª—å–Ω—ã–π –∑–≤–æ–Ω–æ–∫**

1. –£–±–µ–¥–∏—Å—å —á—Ç–æ Asterisk –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª—Å—è –Ω–∞ Mango (—Å–º. —à–∞–≥ 2)
2. –ü–æ–∑–≤–æ–Ω–∏ –Ω–∞ `+7 (991) 898-74-23` —Å –º–æ–±–∏–ª—å–Ω–æ–≥–æ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
3. –ó–≤–æ–Ω–æ–∫ –¥–æ–ª–∂–µ–Ω –ø—Ä–∏–π—Ç–∏ –Ω–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –Ω–æ–º–µ—Ä 1001
4. –í –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ –ø–æ—è–≤–∏—Ç—Å—è –∫–∞—Ä—Ç–æ—á–∫–∞ –∑–≤–æ–Ω–∫–∞
5. –ì–æ–≤–æ—Ä–∏ —á—Ç–æ-–Ω–∏–±—É–¥—å ‚Äî —É–≤–∏–¥–∏—à—å —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—é –∏ –ø–æ–¥—Å–∫–∞–∑–∫–∏ AI

---

## üêõ –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:

### Backend –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
```bash
# –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
pip list | grep -E "(fastapi|soniox|httpx)"

# –ü—Ä–æ–≤–µ—Ä—å .env —Ñ–∞–π–ª
cat .env

# –°–º–æ—Ç—Ä–∏ –ª–æ–≥–∏
# –û—à–∏–±–∫–∏ –±—É–¥—É—Ç –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –≥–¥–µ –∑–∞–ø—É—â–µ–Ω uvicorn
```

### Asterisk –Ω–µ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –Ω–∞ Mango
```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
asterisk -rvvv

# –í –∫–æ–Ω—Å–æ–ª–∏ Asterisk –≤—ã–ø–æ–ª–Ω–∏:
pjsip show registrations
pjsip show endpoint mango-trunk

# –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ:
# 1. –ü–∞—Ä–æ–ª—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤ /etc/asterisk/pjsip.conf
# 2. IP –∞–¥—Ä–µ—Å–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω—ã –≤ –õ–ö Mango (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
# 3. –ü–æ—Ä—Ç 5060 UDP –æ—Ç–∫—Ä—ã—Ç
```

### Frontend –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ backend
```bash
# –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ backend –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 8000
curl http://localhost:8000/api/health

# –û—Ç–∫—Ä–æ–π –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12)
# –°–º–æ—Ç—Ä–∏ –æ—à–∏–±–∫–∏ WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
```

### –ù–µ—Ç —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏
```bash
# –ü—Ä–æ–≤–µ—Ä—å Soniox API –∫–ª—é—á
echo $SONIOX_API_KEY

# –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –∑–∞–ø–∏—Å–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è
ls -la /var/spool/asterisk/recording/

# –ü—Ä–æ–≤–µ—Ä—å —Ñ–æ—Ä–º–∞—Ç –∞—É–¥–∏–æ (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å WAV, 16kHz, mono)
file /var/spool/asterisk/recording/–ø–æ—Å–ª–µ–¥–Ω–∏–π-—Ñ–∞–π–ª.wav
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–∞—Å—Ö–æ–¥–æ–≤

**OpenRouter:**
- –ó–∞–π–¥–∏ –Ω–∞ https://openrouter.ai/activity
- –°–º–æ—Ç—Ä–∏ —Å–∫–æ–ª—å–∫–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ —Ç–æ–∫–µ–Ω–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å

**Soniox:**
- Dashboard: https://console.soniox.com/
- –°–º–æ—Ç—Ä–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –º–∏–Ω—É—Ç

**–ü—Ä–∏–º–µ—Ä–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å:**
- 100 –∑–≤–æ–Ω–∫–æ–≤/–¥–µ–Ω—å –ø–æ 5 –º–∏–Ω—É—Ç = ~$4-5/–¥–µ–Ω—å
- ~$120-150/–º–µ—Å—è—Ü

---

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è (–∫–æ–≥–¥–∞ –±–∞–∑–æ–≤–∞—è –≤–µ—Ä—Å–∏—è –∑–∞—Ä–∞–±–æ—Ç–∞–µ—Ç)

1. **–ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ backend –Ω–∞ VPS** (—á—Ç–æ–±—ã –Ω–µ –¥–µ—Ä–∂–∞—Ç—å –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ)
2. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å HTTPS** (–¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)
3. **–î–æ–±–∞–≤–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö** (PostgreSQL) –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏ –∑–≤–æ–Ω–∫–æ–≤
4. **–ö–∞—Å—Ç–æ–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–º–ø—Ç—ã** –ø–æ–¥ —Å–ø–µ—Ü–∏—Ñ–∏–∫—É —Ç–≤–æ–µ–π –∫–æ–º–ø–∞–Ω–∏–∏
5. **–î–æ–±–∞–≤–∏—Ç—å RAG** (–±–∞–∑–∞ –∑–Ω–∞–Ω–∏–π –∫–æ–º–ø–∞–Ω–∏–∏ –¥–ª—è –±–æ–ª–µ–µ —Ç–æ—á–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤)
6. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** (Grafana + Prometheus)

---

## üìû –ï—Å–ª–∏ –∑–∞—Å—Ç—Ä—è–ª - –ø–∏—à–∏ –≤ —á–∞—Ç!

–°–∫–∏–¥—ã–≤–∞–π:
- –õ–æ–≥–∏ –∏–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞
- –°–∫—Ä–∏–Ω—ã –æ—à–∏–±–æ–∫
- –ß—Ç–æ –∏–º–µ–Ω–Ω–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

–†–∞–∑–±–µ—Ä–µ–º—Å—è! üí™
